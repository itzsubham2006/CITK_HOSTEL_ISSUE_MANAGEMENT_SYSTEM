{% extends "base.html" %}
{% block content %}

<form method="get" class="hostel-switch">
  <label>Select Hostel:</label>
  <select name="hostel" onchange="this.form.submit()">
    {% for h in ["SJ","JD","BJ","SNM","Bakhungri","Gambari"] %}
      <option value="{{ h }}" {{ "selected" if hostel == h }}>
        {{ h }} Hostel
      </option>
    {% endfor %}
  </select>
</form>

<div id="hostelData"
     data-room-map='{{ room_map | tojson }}'
     data-is-staff="{{ is_staff | lower }}"
     data-capacity="{{ capacity }}">
</div>

<section class="hostel-map-section">
  <h2 class="section-title">üè† {{ hostel }} ‚Äì Room Layout</h2>

  <div class="floors-container">
    {% for floor, start, end in [
      ("Ground Floor", 101, 142),
      ("1st Floor", 201, 242),
      ("2nd Floor", 301, 342),
      ("3rd Floor", 401, 444)
    ] %}
    <div class="floor">
      <div class="floor-title">{{ floor }}</div>

      <div class="rooms">
        {% for room in range(start, end + 1) %}
          {% set r = room|string %}
          {% set count = room_map[r]|length if r in room_map else 0 %}

          <div class="room
              {% if count == 0 %}empty
              {% elif count < capacity %}occupied
              {% else %}full
              {% endif %}"
               data-room="{{ room }}">
            {{ room }}
          </div>

        {% endfor %}
      </div>
    </div>
    {% endfor %}
  </div>
</section>


<!-- ROOM MODAL -->
<div class="room-modal" id="roomModal">
  <div class="modal-content">
    <span class="close-btn" id="closeModal">√ó</span>
    <h3 id="modalRoomTitle"></h3>
    <div id="modalContent"></div>
    <button id="addStudentBtn" class="add-btn"></button>
  </div>
</div>



<script src="{{ url_for('static', filename='js/hostel_rooms.js') }}"></script>
{% endblock %}
