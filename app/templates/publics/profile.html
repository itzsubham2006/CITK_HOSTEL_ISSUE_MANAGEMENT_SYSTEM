{% extends 'base.html' %}

{% block content %}

<div class="profile-wrapper">

  <!-- PROFILE HEADER -->
  <div class="profile-header">
    <div class="profile-pic">
      

      {% if current_user.profile_pic %}
        <img src="{{ url_for('static', filename='uploads/' + current_user.profile_pic) }}">
      {% else %}
        <img src="{{ url_for('static', filename='uploads/default_user.png') }}">
      {% endif %}
      <form method="POST"
      action="{{ url_for('students.upload_profile_pic') }}"
      enctype="multipart/form-data">

    <input type="file"
          name="profile_pic"
          accept="image/*"
          required>

    <button type="submit">Update Profile Picture</button>
</form>
    </div>

    <div class="profile-info">
      <h2>Username: {{ current_user.username }}</h2>
      <p>Email: {{ current_user.email }}</p>
      <p>Hostel: {{ current_user.hostel }}</p>
      <p>Room No: {{ current_user.room_no }}</p>
    </div>
  </div>

  <!-- REPORTED ISSUES -->
  <h3 class="section-title">Your Reported Issues</h3>
  {% for issue in issues %}
    <div class="issue-card">
      <b>{{ issue.category }}</b> â€” {{ issue.status }}
      <p>{{ issue.description }}</p>
    </div>
  {% else %}
    <p class="empty">No issues reported.</p>
  {% endfor %}

  <!-- HOSTEL DIARIES -->
  <h3 class="section-title">Your Hostel Diaries</h3>
  <div class="diary-grid">
    {% for diary in diaries %}
      <div class="diary-card">
        <img src="{{ url_for('static', filename='uploads/' + diary.image) }}">
        <p>{{ diary.caption }}</p>

       
        <a href="{{ url_for('students.delete_diary', id=diary.id) }}"
           class="delete-btn"
           onclick="return confirm('Delete this diary?')">
           ðŸ—‘ Delete
        </a>
      </div>
    {% else %}
      <p class="empty">No diaries yet.</p>
    {% endfor %}
  </div>

</div>

{% endblock %}
